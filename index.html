<!DOCTYPE html>
<html lang="en">
<head>
  <style>
  body {
    background: #f7f7f7;
    margin: 0;
    padding: 10px;
    font-family: "Noto Sans", sans-serif;
  }
  #forum-box {
    max-width: 650px;
    margin: 20px auto;
    background: #fff;
    padding: 15px;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  }
  h1 {
    font-size: 1.4em;
    text-align: center;
  }
</style>

<meta charset="UTF-8">
<meta name="description" content="Forum komuniti skateboard Malaysia. Sertai perbincangan dalam Bahasa Melayu, English, dan ä¸­æ–‡.">
<meta name="keywords" content="skateboard, forum, malaysia, ä¸­æ–‡, bahasa melayu, english">
<meta name="author" content="Skateboard.my">
<title>Skateboard Forum</title>
</head>
<body>
  <div id="forum-box">
  <h1 id="pageTitle">ğŸ’¬ Forum</h1>
  <!--
  <div>
    <button onclick="switchLang('en')">English</button>
    <button onclick="switchLang('ms')">Bahasa Melayu</button>
    <button onclick="switchLang('zh_CN')">ä¸­æ–‡</button>
  </div>
  -->
  <div id="disqus_thread"></div>
  </div>
  <script>
  // è‡ªå‹•èªè¨€åµæ¸¬ + æœ¬åœ°è¨­å®š
  let userLang = localStorage.getItem('lang') || 
                 (navigator.language.startsWith('zh') ? 'zh_CN' :
                  navigator.language.startsWith('ms') ? 'ms' : 'en');

  // æ ¹æ“šèªè¨€æ”¹é é¢æ¨™é¡Œ
  const titles = { en: "ğŸ’¬ Skateboard.my Forum", ms: "ğŸ’¬ Forum Skateboard.my", zh_CN: "ğŸ’¬ Skateboard.my æ»‘æ¿è®ºå›" };
  document.getElementById('pageTitle').innerText = titles[userLang] || titles['en'];

  // å»ºç«‹ disqus_config
  var disqus_config = function () {
    this.page.url = window.location.href;
    //this.page.identifier = window.location.pathname;

    // æ ¹æ“š URL åˆ¤æ–·æ˜¯å¦æœ‰æŒ‡å®šç‰ˆï¼ˆä¾‹å¦‚ /forum/tech æˆ– /topic/streetï¼‰
    var path = window.location.pathname;

    // è‹¥ path å¤ªçŸ­ï¼ˆä¾‹å¦‚åªæ˜¯ "/" æˆ– "/forum"ï¼‰ï¼Œä½¿ç”¨ä¸»ç‰ˆ "sk-main"
    if (path === "/" || path === "/forum" || path === "/forum/") {
      this.page.identifier = "sk-main";
    } else {
      // å¦å‰‡ç”¨ç›®å‰è·¯å¾‘ä½œç‚ºç‰ˆçš„è­˜åˆ¥ç¢¼
      this.page.identifier = path.replace(/\//g, "-").replace(/^-|-$/g, "");
    }

    this.language = userLang;
  };

  // è¼‰å…¥ Disqus
  (function() {
    var d = document, s = d.createElement('script');
    s.src = 'https://skateboard-my.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();

  // åˆ‡æ›èªè¨€
  function switchLang(lang) {
    localStorage.setItem('lang', lang);
    location.reload();
  }
  

    
  </script>
</body>
</html>

<!-- iframe å…§é  (GitHub Pages) -->
<script>
(function() {
  // å‚³é€ç›®å‰é«˜åº¦çµ¦çˆ¶è¦–çª—
  function postHeight() {
    const h = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);
    window.parent.postMessage({ type: 'resizeForum', height: h }, '*');
  }

  // 1) ç•¶é é¢ load æ™‚å…ˆç™¼ä¸€æ¬¡
  window.addEventListener('load', function() {
    postHeight();
    // å†ç­‰ 1000ms å†ç™¼ä¸€æ¬¡ï¼Œç¢ºä¿ç¬¬ä¸‰æ–¹éƒ¨ä»¶ (Disqus) åŠ è¼‰å®Œ
    setTimeout(postHeight, 1000);
  });

  // 2) MutationObserverï¼šç›£è½ DOM è®ŠåŒ–ï¼ˆä¾‹å¦‚ Disqus åŠ å…¥ç•™è¨€ç¯€é»ï¼‰
  const observer = new MutationObserver(function(mutations) {
    // è‹¥æœ‰è®Šå‹•ï¼Œå»¶é²ç™¼é€ï¼ˆé¿å…éå¤š postMessageï¼‰
    clearTimeout(window.__resizeTimeout);
    window.__resizeTimeout = setTimeout(postHeight, 200);
  });

  observer.observe(document.body, { childList: true, subtree: true, attributes: true });

  // 3) fallback pollï¼šè‹¥ MutationObserver ä¸å¯é ï¼Œå®šæœŸæª¢æŸ¥é«˜åº¦è®ŠåŒ–
  let lastH = 0;
  setInterval(function() {
    const h = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);
    if (Math.abs(h - lastH) > 10) { // åªåœ¨é«˜åº¦æœ‰æ˜é¡¯è®ŠåŒ–æ™‚ç™¼é€
      lastH = h;
      postHeight();
    }
  }, 800);

  // 4) å›æ‡‰çˆ¶é é¢ requestHeight
  window.addEventListener('message', function(e) {
    const d = e.data || {};
    if (d.type === 'requestHeight') postHeight();
  }, false);

  // å¦‚éœ€ debugï¼Œè§£é™¤ä¸‹é¢è¨»è§£æœƒåœ¨ console é¡¯ç¤ºé«˜åº¦
  // setInterval(()=>console.log('height', document.body.scrollHeight), 2000);
})();
</script>


